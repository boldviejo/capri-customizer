import{r as n,j as e,a as y}from"./components-DFXdd6rU.js";function j({onUploadComplete:r,onUploadError:d,className:i=""}){const[o,l]=n.useState(!1),[c,u]=n.useState(0),s=n.useRef(null),x=async m=>{var p;const a=(p=m.target.files)==null?void 0:p[0];if(a)try{l(!0),u(0);const t=await fetch("/api/upload-url",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({fileName:a.name,contentType:a.type})});if(!t.ok){const g=await t.json();throw new Error(g.message||"Failed to get upload URL")}const{uploadUrl:h,fileUrl:b}=await t.json();if(!(await fetch(h,{method:"PUT",headers:{"Content-Type":a.type},body:a})).ok)throw new Error("Failed to upload file to storage");s.current&&(s.current.value=""),r(b)}catch(t){console.error("Error uploading file:",t),d&&t instanceof Error&&d(t)}finally{l(!1),u(0)}},f=()=>{var m;(m=s.current)==null||m.click()};return e.jsxs("div",{className:`cloud-image-uploader ${i}`,children:[e.jsx("input",{type:"file",ref:s,onChange:x,accept:"image/*",className:"hidden"}),e.jsx("button",{type:"button",onClick:f,disabled:o,className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:bg-blue-300",children:o?`Uploading... ${c}%`:"Upload Image"}),o&&e.jsx("div",{className:"w-full mt-2 bg-gray-200 rounded-full h-2.5",children:e.jsx("div",{className:"bg-blue-600 h-2.5 rounded-full",style:{width:`${c}%`}})})]})}function U(){const[r,d]=n.useState(""),[i,o]=n.useState(null),l=y(),c=s=>{d(s),o(null)},u=s=>{o(s.message)};return e.jsxs("div",{className:"max-w-md mx-auto p-6 bg-white rounded-lg shadow-md",children:[e.jsx("h1",{className:"text-2xl font-bold mb-6",children:"Product Form"}),e.jsxs("form",{method:"post",className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700",children:"Product Name"}),e.jsx("input",{type:"text",id:"name",name:"name",className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Product Image"}),e.jsx(j,{onUploadComplete:c,onUploadError:u,className:"mb-2"}),i&&e.jsx("p",{className:"text-red-500 text-sm",children:i}),r&&e.jsxs("div",{className:"mt-2",children:[e.jsx("p",{className:"text-sm text-gray-500 mb-2",children:"Preview:"}),e.jsx("img",{src:r,alt:"Preview",className:"max-w-full h-auto max-h-48 rounded"}),e.jsx("input",{type:"hidden",name:"imageUrl",value:r})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700",children:"Description"}),e.jsx("textarea",{id:"description",name:"description",rows:3,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]}),e.jsx("button",{type:"submit",className:"w-full px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Submit"}),(l==null?void 0:l.success)&&e.jsx("p",{className:"text-green-500",children:"Form submitted successfully!"})]})]})}export{U as default};
